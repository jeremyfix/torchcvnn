<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="torchcvnn.nn" href="nn.html" /><link rel="prev" title="Installation" href="../getting_started/installing.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>torchcvnn.datasets - torchcvnn 0.7.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">torchcvnn 0.7.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">torchcvnn 0.7.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installing.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">torchcvnn.datasets</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="nn.html">torchcvnn.nn</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of torchcvnn.nn</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.ConvTranspose2d.html">torchcvnn.nn.ConvTranspose2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.MaxPool2d.html">torchcvnn.nn.MaxPool2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.AvgPool2d.html">torchcvnn.nn.AvgPool2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.Upsample.html">torchcvnn.nn.Upsample</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.CCELU.html">torchcvnn.nn.CCELU</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.CELU.html">torchcvnn.nn.CELU</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.CGELU.html">torchcvnn.nn.CGELU</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.CReLU.html">torchcvnn.nn.CReLU</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.CPReLU.html">torchcvnn.nn.CPReLU</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.CSigmoid.html">torchcvnn.nn.CSigmoid</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.CTanh.html">torchcvnn.nn.CTanh</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.Cardioid.html">torchcvnn.nn.Cardioid</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.Mod.html">torchcvnn.nn.Mod</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.modReLU.html">torchcvnn.nn.modReLU</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.zAbsReLU.html">torchcvnn.nn.zAbsReLU</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.zLeakyReLU.html">torchcvnn.nn.zLeakyReLU</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.zReLU.html">torchcvnn.nn.zReLU</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.MultiheadAttention.html">torchcvnn.nn.MultiheadAttention</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.BatchNorm2d.html">torchcvnn.nn.BatchNorm2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.BatchNorm1d.html">torchcvnn.nn.BatchNorm1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.LayerNorm.html">torchcvnn.nn.LayerNorm</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.RMSNorm.html">torchcvnn.nn.RMSNorm</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.Transformer.html">torchcvnn.nn.Transformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.TransformerEncoderLayer.html">torchcvnn.nn.TransformerEncoderLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/torchcvnn.nn.TransformerDecoderLayer.html">torchcvnn.nn.TransformerDecoderLayer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="init.html">torchcvnn.nn.init</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/complex_mnist.html">Classification of MNIST digit from their Fourier representation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/loading_remote.html">Remote sensing data loading</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/jeremyfix/torchcvnn/blob/main/docs/source/modules/datasets.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/jeremyfix/torchcvnn/edit/main/docs/source/modules/datasets.rst" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="torchcvnn-datasets">
<h1>torchcvnn.datasets<a class="headerlink" href="#torchcvnn-datasets" title="Link to this heading">¶</a></h1>
<section id="bretigny">
<h2>Bretigny<a class="headerlink" href="#bretigny" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="torchcvnn.datasets.Bretigny">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchcvnn.datasets.</span></span><span class="sig-name descname"><span class="pre">Bretigny</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">balanced</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(128,</span> <span class="pre">128)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchcvnn/datasets/bretigny/dataset.html#Bretigny"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchcvnn.datasets.Bretigny" title="Link to this definition">¶</a></dt>
<dd><p>Bretigny Dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root</strong> – the root directory containing the npz files for Bretigny</p></li>
<li><p><strong>fold</strong> – train (70%), valid (15%), or test (15%)</p></li>
<li><p><strong>transform</strong> – the transform applied the cropped image</p></li>
<li><p><strong>balanced</strong> – whether or not to use balanced labels</p></li>
<li><p><strong>patch_size</strong> – the dimensions of the patches to consider (rows, cols)</p></li>
<li><p><strong>patch_stride</strong> – the shift between two consecutive patches, default:patch_size</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An example usage :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torchcvnn</span>
<span class="kn">from</span> <span class="nn">torchcvnn.datasets</span> <span class="kn">import</span> <span class="n">Bretigny</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">Bretigny</span><span class="p">(</span>
    <span class="n">rootdir</span><span class="p">,</span> <span class="n">fold</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">patch_size</span><span class="o">=</span><span class="p">((</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)),</span> <span class="n">transform</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Displayed below are the train, valid and test parts with the labels overlayed</p>
<a class="reference internal image-reference" href="../_images/bretigny_train.png"><img alt="Train fold" src="../_images/bretigny_train.png" style="width: 60%;" />
</a>
<a class="reference internal image-reference" href="../_images/bretigny_valid.png"><img alt="Valid fold" src="../_images/bretigny_valid.png" style="width: 15%;" />
</a>
<a class="reference internal image-reference" href="../_images/bretigny_test.png"><img alt="Test fold" src="../_images/bretigny_test.png" style="width: 15%;" />
</a>
</div>
</dd></dl>

</section>
<section id="polsf">
<h2>PolSF<a class="headerlink" href="#polsf" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="torchcvnn.datasets.PolSFDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchcvnn.datasets.</span></span><span class="sig-name descname"><span class="pre">PolSFDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(128,</span> <span class="pre">128)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchcvnn/datasets/polsf.html#PolSFDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchcvnn.datasets.PolSFDataset" title="Link to this definition">¶</a></dt>
<dd><p>The Polarimetric SAR dataset with the labels provided by
<a class="reference external" href="https://ietr-lab.univ-rennes1.fr/polsarpro-bio/san-francisco/">https://ietr-lab.univ-rennes1.fr/polsarpro-bio/san-francisco/</a></p>
<p>We expect the data to be already downloaded and available on your drive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root</strong> – the top root dir where the data are expected</p></li>
<li><p><strong>transform</strong> – the transform applied the cropped image</p></li>
<li><p><strong>patch_size</strong> – the dimensions of the patches to consider (rows, cols)</p></li>
<li><p><strong>patch_stride</strong> – the shift between two consecutive patches, default:patch_size</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An example usage :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torchcvnn</span>
<span class="kn">from</span> <span class="nn">torchcvnn.datasets</span> <span class="kn">import</span> <span class="n">PolSFDataset</span>

<span class="k">def</span> <span class="nf">transform_patches</span><span class="p">(</span><span class="n">patches</span><span class="p">):</span>
    <span class="c1"># We keep all the patches and get the spectrum</span>
    <span class="c1"># from it</span>
    <span class="c1"># If you wish, you could filter out some polarizations</span>
    <span class="c1"># PolSF provides the four HH, HV, VH, VV</span>
    <span class="n">patches</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">patchi</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">patchi</span> <span class="ow">in</span> <span class="n">patches</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">patches</span><span class="p">)</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">PolSFDataset</span><span class="p">(</span><span class="n">rootdir</span><span class="p">,</span> <span class="n">patch_size</span><span class="o">=</span><span class="p">((</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">)),</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform_patches</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Displayed below are example patches with patch sizes <span class="math notranslate nohighlight">\(512 \times 512\)</span>
with the labels overlayed</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/polsf.png"><img alt="Patches from the PolSF dataset" src="../_images/polsf.png" style="width: 100%;" />
</a>
</figure>
</div>
</dd></dl>

</section>
<section id="alos2">
<h2>ALOS2<a class="headerlink" href="#alos2" title="Link to this heading">¶</a></h2>
<p>We provide a generic class for parsing ALOS2 data which is the format developed
by the Japanese Aerospace Exploration Agency (JAXA).</p>
<dl class="py class">
<dt class="sig sig-object py" id="torchcvnn.datasets.ALOSDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchcvnn.datasets.</span></span><span class="sig-name descname"><span class="pre">ALOSDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_coordinates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(128,</span> <span class="pre">128)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchcvnn/datasets/alos2/dataset.html#ALOSDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchcvnn.datasets.ALOSDataset" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a></p>
<p>The format is described in
<a class="reference external" href="https://www.eorc.jaxa.jp/ALOS/en/alos-2/pdf/product_format_description/PALSAR-2_xx_Format_CEOS_E_g.pdf">https://www.eorc.jaxa.jp/ALOS/en/alos-2/pdf/product_format_description/PALSAR-2_xx_Format_CEOS_E_g.pdf</a></p>
<p>The dataset is constructed from the volume file. If leader and trailer files
are colocated, they are loaded as well.</p>
<p>Important, this code has been developed for working with L1.1 HBQ-R Quad Pol
datafiles. It is not expected to work out of the box for other levels and
for less than 4 polarizations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>volpath</strong> – the path to the VOLUME file</p></li>
<li><p><strong>transform</strong> – the transform applied the cropped image. It applies
on a dictionnary of patches {‘HH’: np.array, ‘HV’: np.array}</p></li>
<li><p><strong>crop_coordinates</strong> – the subpart of the image to consider as ((row_i, col_i), (row_j, col_j))
defining the corner coordinates</p></li>
<li><p><strong>patch_size</strong> – the dimensions of the patches to consider (rows, cols)</p></li>
<li><p><strong>patch_stride</strong> – the shift between two consecutive patches, default:patch_size</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p>This class itself involves several parsers to process the :</p>
<ul class="simple">
<li><p>volume file <a class="reference internal" href="#torchcvnn.datasets.alos2.VolFile" title="torchcvnn.datasets.alos2.VolFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchcvnn.datasets.alos2.VolFile</span></code></a></p></li>
<li><p>leader file <a class="reference internal" href="#torchcvnn.datasets.alos2.LeaderFile" title="torchcvnn.datasets.alos2.LeaderFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchcvnn.datasets.alos2.LeaderFile</span></code></a>,</p></li>
<li><p>image file <a class="reference internal" href="#torchcvnn.datasets.alos2.SARImage" title="torchcvnn.datasets.alos2.SARImage"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchcvnn.datasets.alos2.SARImage</span></code></a>,</p></li>
<li><p>trailer file <a class="reference internal" href="#torchcvnn.datasets.alos2.TrailerFile" title="torchcvnn.datasets.alos2.TrailerFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchcvnn.datasets.alos2.TrailerFile</span></code></a>.</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="torchcvnn.datasets.alos2.VolFile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchcvnn.datasets.alos2.</span></span><span class="sig-name descname"><span class="pre">VolFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><span class="pre">Path</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchcvnn/datasets/alos2/vol_file.html#VolFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchcvnn.datasets.alos2.VolFile" title="Link to this definition">¶</a></dt>
<dd><p>Processing a Volume Directory file in the CEOS format. The parsed
informations can be accessed through the attributes <cite>descriptor_records</cite>,
<cite>file_pointer_records</cite> and <cite>text_records</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filepath</strong> – the path to the volume directory file</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchcvnn.datasets.alos2.LeaderFile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchcvnn.datasets.alos2.</span></span><span class="sig-name descname"><span class="pre">LeaderFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchcvnn/datasets/alos2/leader_file.html#LeaderFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchcvnn.datasets.alos2.LeaderFile" title="Link to this definition">¶</a></dt>
<dd><p>Processing of the SAR trailer file.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchcvnn.datasets.alos2.SARImage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchcvnn.datasets.alos2.</span></span><span class="sig-name descname"><span class="pre">SARImage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchcvnn/datasets/alos2/sar_image.html#SARImage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchcvnn.datasets.alos2.SARImage" title="Link to this definition">¶</a></dt>
<dd><p>Processing of the SAR Image</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchcvnn.datasets.alos2.TrailerFile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchcvnn.datasets.alos2.</span></span><span class="sig-name descname"><span class="pre">TrailerFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchcvnn/datasets/alos2/trailer_file.html#TrailerFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchcvnn.datasets.alos2.TrailerFile" title="Link to this definition">¶</a></dt>
<dd><p>Processing of the SAR trailer file.</p>
</dd></dl>

</section>
<section id="slc">
<h2>SLC<a class="headerlink" href="#slc" title="Link to this heading">¶</a></h2>
<p>SLC is popular remote sensing format. The <a class="reference external" href="https://uavsar.jpl.nasa.gov/">Nasa Jet Lab UAV SAR</a> mission for example provides several SLC stacks.</p>
<dl class="py class">
<dt class="sig sig-object py" id="torchcvnn.datasets.SLCDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchcvnn.datasets.</span></span><span class="sig-name descname"><span class="pre">SLCDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rootdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(128,</span> <span class="pre">128)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchcvnn/datasets/slc/dataset.html#SLCDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchcvnn.datasets.SLCDataset" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a></p>
<p>The format is described in <a class="reference external" href="https://uavsar.jpl.nasa.gov/science/documents/stack-format.html">https://uavsar.jpl.nasa.gov/science/documents/stack-format.html</a></p>
<p>This object does not download the data for you, you must have the data on your local machine. For example, you can
register and access data from the NASA JetLab <a class="reference external" href="https://uavsar.jpl.nasa.gov">https://uavsar.jpl.nasa.gov</a></p>
<p>Note the datafiles can be quite large. For example, the quad polarization from Los Angeles SSurge_15305 is a bit
more than 30 GB. If you take the downsampled datasets 2x8, it is 2GB.</p>
<p>Note the 1x1 is 1.67 m slant range x 0.6 m azimuth.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As an example, using the example <cite>read_slc.py</cite>, with the SSurge_15305 stack provided
by the UAVSar, the Pauli representation of the four polarizations is shown below :</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/slc_SSurge_15305.png"><img alt="Pauli representation of a :math:`3000 \times 3000` crop of the SSurge_15305 stack" src="../_images/slc_SSurge_15305.png" style="width: 50%;" />
</a>
</figure>
<p>The code may look like this :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">torchcvnn</span>
<span class="kn">from</span> <span class="nn">torchcvnn.datasets.slc.dataset</span> <span class="kn">import</span> <span class="n">SLCDataset</span>

<span class="k">def</span> <span class="nf">get_pauli</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="c1"># Returns Pauli in (H, W, C)</span>
    <span class="n">HH</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;HH&quot;</span><span class="p">]</span>
    <span class="n">HV</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;HV&quot;</span><span class="p">]</span>
    <span class="n">VH</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;VH&quot;</span><span class="p">]</span>
    <span class="n">VV</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;VV&quot;</span><span class="p">]</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="n">HH</span> <span class="o">+</span> <span class="n">VV</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">HH</span> <span class="o">-</span> <span class="n">VV</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">HV</span> <span class="o">+</span> <span class="n">VH</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">alpha</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>


<span class="n">patch_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">SLCDataset</span><span class="p">(</span>
    <span class="n">rootdir</span><span class="p">,</span>
    <span class="n">transform</span><span class="o">=</span><span class="n">get_pauli</span><span class="p">,</span>
    <span class="n">patch_size</span><span class="o">=</span><span class="n">patch_size</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rootdir</strong> – the path containing the SLC and ANN files</p></li>
<li><p><strong>transform</strong> – the transform applied to the patches. It applies
on a dictionnary of patches {‘HH’: np.array, ‘HV’: np.array, …}</p></li>
<li><p><strong>patch_size</strong> – the dimensions of the patches to consider (rows, cols)</p></li>
<li><p><strong>patch_stride</strong> – the shift between two consecutive patches, default:patch_size</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p>This class involves several parsers for parsing :</p>
<ul class="simple">
<li><p>the annotation file <a class="reference internal" href="#torchcvnn.datasets.slc.ann_file.AnnFile" title="torchcvnn.datasets.slc.ann_file.AnnFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchcvnn.datasets.slc.ann_file.AnnFile</span></code></a></p></li>
<li><p>the SLC files <a class="reference internal" href="#torchcvnn.datasets.slc.slc_file.SLCFile" title="torchcvnn.datasets.slc.slc_file.SLCFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchcvnn.datasets.slc.slc_file.SLCFile</span></code></a></p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="torchcvnn.datasets.slc.ann_file.AnnFile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchcvnn.datasets.slc.ann_file.</span></span><span class="sig-name descname"><span class="pre">AnnFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchcvnn/datasets/slc/ann_file.html#AnnFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchcvnn.datasets.slc.ann_file.AnnFile" title="Link to this definition">¶</a></dt>
<dd><p>From the documentation :</p>
<p>The annotation file (.ann) is a keyword/value ASCII file in which the value on the right of the equals sign
corresponds to the keyword on the left of the equals sign. The number of keywords may change with time, so the line
number should not be assumed to be constant for any given keyword.</p>
<p>In addition, the spacing between keywords and
values may change. The units are given in parenthesis between the keyword and equal sign, and may change from
annotation file to annotation file and within each annotation file.</p>
<p>Comments are indicated by semicolons (;), and
may occur at the beginning of a line, or at the middle of a line (everything after the semicolon on that line is a
comment). The length of each text line is variable, and ends with a carriage return. There may be lines with
just a carriage return or spaces and a carriage return.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchcvnn.datasets.slc.slc_file.SLCFile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchcvnn.datasets.slc.slc_file.</span></span><span class="sig-name descname"><span class="pre">SLCFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchcvnn/datasets/slc/slc_file.html#SLCFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchcvnn.datasets.slc.slc_file.SLCFile" title="Link to this definition">¶</a></dt>
<dd><p>Reads a SLC file</p>
<p>The filenames contain interesting information:</p>
<p>{site name}_{line ID}_{flight ID}_{data take counter}_{acquisition date}_{band}{steering}{polarization}_{stack_version}… _{baseline correction}_{segment number}_{downsample factor}.slc</p>
<p>e.g. SSurge_15305_14170_007_141120_L090HH_01_BC_s1_1x1.slc is</p>
<ul class="simple">
<li><p>site_name : SSurge</p></li>
<li><p>line ID : 15305</p></li>
<li><p>flight ID : 14170</p></li>
<li><p>data take counter : 007</p></li>
<li><p>acquisition date : 141120, the date is in YYMMDD format (UTC time).</p></li>
<li><p>band : L</p></li>
<li><p>steering : 090</p></li>
<li><p>polarization : HH</p></li>
<li><p>stack version : 01</p></li>
<li><p>baseline correction : BC, means the data is corrected for residual baseline</p></li>
<li><p>segment number : s1</p></li>
<li><p>downsample factor : 1x1</p></li>
</ul>
<p>There is one SLC file per segment and per polarization.</p>
</dd></dl>

</section>
<section id="mstar">
<h2>MSTAR<a class="headerlink" href="#mstar" title="Link to this heading">¶</a></h2>
<p>MSTAR is a popular radar dataset where the task is to classify military vehicles (tanks, trucks, guns, bulldozer, etc).
To use this dataset, you need to manually download the data before hand and to unpack them into the same directory :</p>
<ul class="simple">
<li><p>MSTAR_PUBLIC_T_72_VARIANTS_CD1 : <a class="reference external" href="https://www.sdms.afrl.af.mil/index.php?collection=mstar&amp;page=variants">https://www.sdms.afrl.af.mil/index.php?collection=mstar&amp;page=variants</a></p></li>
<li><p>MSTAR_PUBLIC_MIXED_TARGETS_CD1 : <a class="reference external" href="https://www.sdms.afrl.af.mil/index.php?collection=mstar&amp;page=mixed">https://www.sdms.afrl.af.mil/index.php?collection=mstar&amp;page=mixed</a></p></li>
<li><p>MSTAR_PUBLIC_MIXED_TARGETS_CD2 : <a class="reference external" href="https://www.sdms.afrl.af.mil/index.php?collection=mstar&amp;page=mixed">https://www.sdms.afrl.af.mil/index.php?collection=mstar&amp;page=mixed</a></p></li>
<li><p>MSTAR_PUBLIC_TARGETS_CHIPS_T72_BMP2_BTR70_SLICY : <a class="reference external" href="https://www.sdms.afrl.af.mil/index.php?collection=mstar&amp;page=targets">https://www.sdms.afrl.af.mil/index.php?collection=mstar&amp;page=targets</a></p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="torchcvnn.datasets.MSTARTargets">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchcvnn.datasets.</span></span><span class="sig-name descname"><span class="pre">MSTARTargets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rootdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchcvnn/datasets/mstar/dataset.html#MSTARTargets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchcvnn.datasets.MSTARTargets" title="Link to this definition">¶</a></dt>
<dd><p>This class implements a PyTorch Dataset for the MSTAR dataset.</p>
<p>The MSTAR dataset is composed of several sub-datasets. The datasets must
be downloaded manually because they require authentication.</p>
<p>To download these datasets, you must register at the following address: <a class="reference external" href="https://www.sdms.afrl.af.mil/index.php?collection=mstar">https://www.sdms.afrl.af.mil/index.php?collection=mstar</a></p>
<p>This dataset object expects all the datasets to be unpacked in the same directory. We can parse the following :</p>
<ul class="simple">
<li><p>MSTAR_PUBLIC_T_72_VARIANTS_CD1 : <a class="reference external" href="https://www.sdms.afrl.af.mil/index.php?collection=mstar&amp;page=variants">https://www.sdms.afrl.af.mil/index.php?collection=mstar&amp;page=variants</a></p></li>
<li><p>MSTAR_PUBLIC_MIXED_TARGETS_CD1 : <a class="reference external" href="https://www.sdms.afrl.af.mil/index.php?collection=mstar&amp;page=mixed">https://www.sdms.afrl.af.mil/index.php?collection=mstar&amp;page=mixed</a></p></li>
<li><p>MSTAR_PUBLIC_MIXED_TARGETS_CD2 : <a class="reference external" href="https://www.sdms.afrl.af.mil/index.php?collection=mstar&amp;page=mixed">https://www.sdms.afrl.af.mil/index.php?collection=mstar&amp;page=mixed</a></p></li>
<li><p>MSTAR_PUBLIC_TARGETS_CHIPS_T72_BMP2_BTR70_SLICY :
<a class="reference external" href="https://www.sdms.afrl.af.mil/index.php?collection=mstar&amp;page=targets">https://www.sdms.afrl.af.mil/index.php?collection=mstar&amp;page=targets</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rootdir</strong> – str</p></li>
<li><p><strong>transform</strong> – the transform applied on the input complex valued array</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An example usage :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torchcvnn</span>
<span class="kn">from</span> <span class="nn">torchcvnn.datasets</span> <span class="kn">import</span> <span class="n">MSTARTargets</span>

<span class="n">transform</span> <span class="o">=</span> <span class="n">v2</span><span class="o">.</span><span class="n">Compose</span><span class="p">(</span>
    <span class="n">transforms</span><span class="o">=</span><span class="p">[</span><span class="n">v2</span><span class="o">.</span><span class="n">ToImage</span><span class="p">(),</span> <span class="n">v2</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="mi">128</span><span class="p">),</span> <span class="n">v2</span><span class="o">.</span><span class="n">CenterCrop</span><span class="p">(</span><span class="mi">128</span><span class="p">)]</span>
<span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">MSTARTargets</span><span class="p">(</span>
    <span class="n">rootdir</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span>
<span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Displayed below are some examples for every class in the dataset. To plot them, we extracted
only the magnitude of the signals although the data are indeed complex valued.</p>
<a class="reference internal image-reference" href="../_images/mstar.png"><img alt="Samples from MSTAR" src="../_images/mstar.png" style="width: 60%;" />
</a>
</div>
</dd></dl>

</section>
<section id="sample">
<h2>SAMPLE<a class="headerlink" href="#sample" title="Link to this heading">¶</a></h2>
<p>SAMPLE is a dataset built from real SAR data as provided by the MSTAR dataset as well a synthetic data. As the original
MSTAR dataset, it contains military vehicles and actually a subset of 10 classes : 2s1, bmp2, btr70, m1, m2, m35, m548, m60, t72, zsu23 . It contains a total of 3968 samples. The SAMPLE dataset is provided by <a class="reference external" href="https://github.com/benjaminlewis-afrl/SAMPLE_dataset_public">https://github.com/benjaminlewis-afrl/SAMPLE_dataset_public</a> .</p>
<dl class="py class">
<dt class="sig sig-object py" id="torchcvnn.datasets.SAMPLE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchcvnn.datasets.</span></span><span class="sig-name descname"><span class="pre">SAMPLE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rootdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">download</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchcvnn/datasets/sample/dataset.html#SAMPLE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchcvnn.datasets.SAMPLE" title="Link to this definition">¶</a></dt>
<dd><p>The SAMPLE dataset is made partly from real data provided by MSTAR and partly from synthetic data.</p>
<p>The dataset is public and will be downloaded if requested and missing on drive.</p>
<p>It is made of 10 classes of military vehicles: 2s1, bmp2, btr70, m1, m2, m35, m548, m60, t72, zsu23</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rootdir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the root directory where the dataset is stored or will be downloaded</p></li>
<li><p><strong>transform</strong> (<a class="reference external" href="https://pytorch.org/vision/stable/generated/torchvision.transforms.Compose.html#torchvision.transforms.Compose" title="(in Torchvision v0.20)"><em>torchvision.transforms.Compose</em></a>) – A list of torchvision transforms to apply to the complex image</p></li>
<li><p><strong>download</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to download the data if missing on disk</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An example usage :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torchcvnn</span>
<span class="kn">from</span> <span class="nn">torchcvnn.datasets</span> <span class="kn">import</span> <span class="n">SAMPLE</span>

<span class="n">transform</span> <span class="o">=</span> <span class="n">v2</span><span class="o">.</span><span class="n">Compose</span><span class="p">(</span>
    <span class="n">transforms</span><span class="o">=</span><span class="p">[</span><span class="n">v2</span><span class="o">.</span><span class="n">ToImage</span><span class="p">(),</span> <span class="n">v2</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="mi">128</span><span class="p">),</span> <span class="n">v2</span><span class="o">.</span><span class="n">CenterCrop</span><span class="p">(</span><span class="mi">128</span><span class="p">)]</span>
<span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">SAMPLE</span><span class="p">(</span>
    <span class="n">rootdir</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Displayed below are some examples drawn randomly from SAMPLE. To plot them, we extracted
only the magnitude of the signals although the data are indeed complex valued.</p>
<a class="reference internal image-reference" href="../_images/SAMPLE.png"><img alt="Samples from MSTAR" src="../_images/SAMPLE.png" style="width: 60%;" />
</a>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="torchcvnn.datasets.SAMPLE.download_file">
<span class="sig-name descname"><span class="pre">download_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><span class="pre">Path</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchcvnn/datasets/sample/dataset.html#SAMPLE.download_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchcvnn.datasets.SAMPLE.download_file" title="Link to this definition">¶</a></dt>
<dd><p>Download a file from an URL and save it on disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – URL to download the file from</p></li>
<li><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>pathlib.Path</em></a>) – Path to save the file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="miccai2023">
<h2>MICCAI2023<a class="headerlink" href="#miccai2023" title="Link to this heading">¶</a></h2>
<p>The MICCAI2023 challenge invovled the task of cine reconstruction where the objective is to predict a full sampled
k-space from an under-sampled k-space. The data come from cardiac MRI.</p>
<dl class="py function">
<dt class="sig sig-object py" id="torchcvnn.datasets.miccai2023.kspace_to_image">
<span class="sig-prename descclassname"><span class="pre">torchcvnn.datasets.miccai2023.</span></span><span class="sig-name descname"><span class="pre">kspace_to_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kspace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.5)"><span class="pre">Tensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.5)"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/torchcvnn/datasets/miccai2023.html#kspace_to_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchcvnn.datasets.miccai2023.kspace_to_image" title="Link to this definition">¶</a></dt>
<dd><p>Convert k-space data to image data. The returned kspace is
of the same type than the the provided image (np.ndarray or torch.Tensor).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kspace</strong> – torch.Tensor or np.ndarray
k-space data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>torch.Tensor or np.ndarray</dt><dd><p>image data</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchcvnn.datasets.miccai2023.image_to_kspace">
<span class="sig-prename descclassname"><span class="pre">torchcvnn.datasets.miccai2023.</span></span><span class="sig-name descname"><span class="pre">image_to_kspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.5)"><span class="pre">Tensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.5)"><span class="pre">Tensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/torchcvnn/datasets/miccai2023.html#image_to_kspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchcvnn.datasets.miccai2023.image_to_kspace" title="Link to this definition">¶</a></dt>
<dd><p>Convert image data to k-space data. The returned kspace is
of the same type than the the provided image (np.ndarray or torch.Tensor)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>img</strong> – torch.Tensor or np.ndarray
Image data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>torch.Tensor or np.ndarray</dt><dd><p>k-space data</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchcvnn.datasets.miccai2023.combine_coils_from_kspace">
<span class="sig-prename descclassname"><span class="pre">torchcvnn.datasets.miccai2023.</span></span><span class="sig-name descname"><span class="pre">combine_coils_from_kspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kspace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/torchcvnn/datasets/miccai2023.html#combine_coils_from_kspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchcvnn.datasets.miccai2023.combine_coils_from_kspace" title="Link to this definition">¶</a></dt>
<dd><p>Combine the coils of the k-space data using the root sum of squares</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kspace</strong> – np.ndarray
k-space data of shape (sc, ky, kx)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>np.ndarray</dt><dd><p>Image data with coils combined, of shape (ky, kx), real valued, positive</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchcvnn.datasets.MICCAI2023">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchcvnn.datasets.</span></span><span class="sig-name descname"><span class="pre">MICCAI2023</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rootdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">CINEView</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">CINEView.SAX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AccFactor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">AccFactor.ACC4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchcvnn/datasets/miccai2023.html#MICCAI2023"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchcvnn.datasets.MICCAI2023" title="Link to this definition">¶</a></dt>
<dd><p>Loads the MICCAI2023 challenge data for the reconstruction task Task 1</p>
<p>The data are described on <a class="reference external" href="https://cmrxrecon.github.io/Task1-Cine-reconstruction.html">https://cmrxrecon.github.io/Task1-Cine-reconstruction.html</a></p>
<p>You need to download the data before hand in order to use this class.</p>
<p>For loading the data, you may want to alternatively consider the fastmri library, see <a class="reference external" href="https://github.com/facebookresearch/fastMRI/">https://github.com/facebookresearch/fastMRI/</a></p>
<p>The structure of the dataset is as follows:</p>
<blockquote>
<div><dl class="simple">
<dt>rootdir/ChallengeData/MultiCoil/cine/TrainingSet/P{id}/</dt><dd><ul class="simple">
<li><p>cine_sax.mat</p></li>
<li><p>cin_lax.mat</p></li>
</ul>
</dd>
<dt>rootdir/ChallengeData/MultiCoil/cine/TrainingSet/AccFactor04/P{id}/</dt><dd><ul class="simple">
<li><p>cine_sax.mat</p></li>
<li><p>cine_sax_mask.mat</p></li>
<li><p>cin_lax.mat</p></li>
<li><p>cine_lax_mask.mat</p></li>
</ul>
</dd>
<dt>rootdir/ChallengeData/MultiCoil/cine/TrainingSet/AccFactor08/P{id}/</dt><dd><ul class="simple">
<li><p>cine_sax.mat</p></li>
<li><p>cine_sax_mask.mat</p></li>
<li><p>cin_lax.mat</p></li>
<li><p>cine_lax_mask.mat</p></li>
</ul>
</dd>
<dt>rootdir/ChallengeData/MultiCoil/cine/TrainingSet/AccFactor10/P{id}/</dt><dd><ul class="simple">
<li><p>cine_sax.mat</p></li>
<li><p>cine_sax_mask.mat</p></li>
<li><p>cin_lax.mat</p></li>
<li><p>cine_lax_mask.mat</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<p>The cine_sax or sine_lax files are <span class="math notranslate nohighlight">\((k_x, k_y, s_c, s_z, t)\)</span> where :</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(k_x\)</span>: matrix size in x-axis (k-space)</p></li>
<li><p><span class="math notranslate nohighlight">\(k_y`\)</span>: matrix size in y-axis (k-space)</p></li>
<li><p><span class="math notranslate nohighlight">\(s_c\)</span>: coil array number (compressed to 10)</p></li>
<li><p><span class="math notranslate nohighlight">\(s_x\)</span>: matrix size in x-axis (image)</p></li>
<li><p><span class="math notranslate nohighlight">\(s_y\)</span>: matrix size in y-axis (image) , used in single-coil data</p></li>
<li><p><span class="math notranslate nohighlight">\(s_z\)</span>: slice number for short axis view, or slice group for long axis (i.e., 3ch, 2ch and 4ch views)</p></li>
<li><p><span class="math notranslate nohighlight">\(t\)</span>: time frame.</p></li>
</ul>
<p>Note the k-space dimensions (in x/y axis) are not the same depending on the patient.</p>
<p>This is a recontruction dataset. The goal is to reconstruct the fully sampled k-space
from the subsampled k-space. The acceleratation factor specifies the subsampling rate.</p>
<p>There are also the Single-Coil data which is not yet considered by this implementation</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An example usage :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torchcvnn</span>
<span class="kn">from</span> <span class="nn">torchcvnn.datasets.miccai2023</span> <span class="kn">import</span> <span class="n">MICCAI2023</span><span class="p">,</span> <span class="n">CINEView</span><span class="p">,</span> <span class="n">AccFactor</span>

<span class="k">def</span> <span class="nf">process_kspace</span><span class="p">(</span><span class="n">kspace</span><span class="p">,</span> <span class="n">coil_idx</span><span class="p">,</span> <span class="n">slice_idx</span><span class="p">,</span> <span class="n">frame_idx</span><span class="p">):</span>
    <span class="n">coil_kspace</span> <span class="o">=</span> <span class="n">kspace</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">coil_idx</span><span class="p">,</span> <span class="n">slice_idx</span><span class="p">,</span> <span class="n">frame_idx</span><span class="p">]</span>
    <span class="n">mod_kspace</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coil_kspace</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-9</span><span class="p">)</span>

    <span class="n">img</span> <span class="o">=</span> <span class="n">kspace_to_image</span><span class="p">(</span><span class="n">coil_kspace</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">img</span> <span class="o">/</span> <span class="n">img</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">mod_kspace</span><span class="p">,</span> <span class="n">img</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">MICCAI2023</span><span class="p">(</span><span class="n">rootdir</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="n">CINEView</span><span class="o">.</span><span class="n">SAX</span><span class="p">,</span> <span class="n">acc_factor</span><span class="o">=</span><span class="n">AccFactor</span><span class="o">.</span><span class="n">ACC8</span><span class="p">)</span>
<span class="n">subsampled_kspace</span><span class="p">,</span> <span class="n">subsampled_mask</span><span class="p">,</span> <span class="n">full_kspace</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">frame_idx</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">slice_idx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">coil_idx</span> <span class="o">=</span> <span class="mi">9</span>

<span class="n">mod_full</span><span class="p">,</span> <span class="n">img_full</span> <span class="o">=</span> <span class="n">process_kspace</span><span class="p">(</span><span class="n">full_kspace</span><span class="p">,</span> <span class="n">coil_idx</span><span class="p">,</span> <span class="n">slice_idx</span><span class="p">,</span> <span class="n">frame_idx</span><span class="p">)</span>
<span class="n">mod_sub</span><span class="p">,</span> <span class="n">img_sub</span> <span class="o">=</span> <span class="n">process_kspace</span><span class="p">(</span><span class="n">subsampled_kspace</span><span class="p">,</span> <span class="n">coil_idx</span><span class="p">,</span> <span class="n">slice_idx</span><span class="p">,</span> <span class="n">frame_idx</span><span class="p">)</span>

<span class="c1"># Plot the above magnitudes</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Displayed below is an example patient with the SAX view and acceleration of 8:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/miccai2023_sax8.png"><img alt="Example patient from the MICCAI2023 dataset with both the full sampled and under sampled k-space and images" src="../_images/miccai2023_sax8.png" style="width: 100%;" />
</a>
</figure>
<p>Displayed below is an example patient with the LAX view and acceleration of 4:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/miccai2023_lax4.png"><img alt="Example patient from the MICCAI2023 dataset with both the full sampled and under sampled k-space and images" src="../_images/miccai2023_lax4.png" style="width: 100%;" />
</a>
</figure>
<p>You can combine the coils using the root sum of squares
to get a magnitude image (real valued) with all the
coil contributions.</p>
<p>Below are examples combining the coils for a given
frame and slice, for LAX (top) and SAX (bottom). It uses
the function <a class="reference internal" href="#torchcvnn.datasets.miccai2023.combine_coils_from_kspace" title="torchcvnn.datasets.miccai2023.combine_coils_from_kspace"><code class="xref py py-func docutils literal notranslate"><span class="pre">torchcvnn.datasets.miccai2023.combine_coils_from_kspace()</span></code></a></p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/miccai2023_combined_lax.png"><img alt="Example LAX, combining the coils" src="../_images/miccai2023_combined_lax.png" style="width: 50%;" />
</a>
</figure>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/miccai2023_combined_sax.png"><img alt="Example SAX, combining the coils" src="../_images/miccai2023_combined_sax.png" style="width: 50%;" />
</a>
</figure>
</div>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="nn.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">torchcvnn.nn</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../getting_started/installing.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Installation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Jeremy Fix
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/jeremyfix/torchcvnn" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">torchcvnn.datasets</a><ul>
<li><a class="reference internal" href="#bretigny">Bretigny</a><ul>
<li><a class="reference internal" href="#torchcvnn.datasets.Bretigny"><code class="docutils literal notranslate"><span class="pre">Bretigny</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#polsf">PolSF</a><ul>
<li><a class="reference internal" href="#torchcvnn.datasets.PolSFDataset"><code class="docutils literal notranslate"><span class="pre">PolSFDataset</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#alos2">ALOS2</a><ul>
<li><a class="reference internal" href="#torchcvnn.datasets.ALOSDataset"><code class="docutils literal notranslate"><span class="pre">ALOSDataset</span></code></a></li>
<li><a class="reference internal" href="#torchcvnn.datasets.alos2.VolFile"><code class="docutils literal notranslate"><span class="pre">VolFile</span></code></a></li>
<li><a class="reference internal" href="#torchcvnn.datasets.alos2.LeaderFile"><code class="docutils literal notranslate"><span class="pre">LeaderFile</span></code></a></li>
<li><a class="reference internal" href="#torchcvnn.datasets.alos2.SARImage"><code class="docutils literal notranslate"><span class="pre">SARImage</span></code></a></li>
<li><a class="reference internal" href="#torchcvnn.datasets.alos2.TrailerFile"><code class="docutils literal notranslate"><span class="pre">TrailerFile</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#slc">SLC</a><ul>
<li><a class="reference internal" href="#torchcvnn.datasets.SLCDataset"><code class="docutils literal notranslate"><span class="pre">SLCDataset</span></code></a></li>
<li><a class="reference internal" href="#torchcvnn.datasets.slc.ann_file.AnnFile"><code class="docutils literal notranslate"><span class="pre">AnnFile</span></code></a></li>
<li><a class="reference internal" href="#torchcvnn.datasets.slc.slc_file.SLCFile"><code class="docutils literal notranslate"><span class="pre">SLCFile</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mstar">MSTAR</a><ul>
<li><a class="reference internal" href="#torchcvnn.datasets.MSTARTargets"><code class="docutils literal notranslate"><span class="pre">MSTARTargets</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sample">SAMPLE</a><ul>
<li><a class="reference internal" href="#torchcvnn.datasets.SAMPLE"><code class="docutils literal notranslate"><span class="pre">SAMPLE</span></code></a><ul>
<li><a class="reference internal" href="#torchcvnn.datasets.SAMPLE.download_file"><code class="docutils literal notranslate"><span class="pre">SAMPLE.download_file()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#miccai2023">MICCAI2023</a><ul>
<li><a class="reference internal" href="#torchcvnn.datasets.miccai2023.kspace_to_image"><code class="docutils literal notranslate"><span class="pre">kspace_to_image()</span></code></a></li>
<li><a class="reference internal" href="#torchcvnn.datasets.miccai2023.image_to_kspace"><code class="docutils literal notranslate"><span class="pre">image_to_kspace()</span></code></a></li>
<li><a class="reference internal" href="#torchcvnn.datasets.miccai2023.combine_coils_from_kspace"><code class="docutils literal notranslate"><span class="pre">combine_coils_from_kspace()</span></code></a></li>
<li><a class="reference internal" href="#torchcvnn.datasets.MICCAI2023"><code class="docutils literal notranslate"><span class="pre">MICCAI2023</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=fe7df9b0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>